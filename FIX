void importFile(String fullFilePath, int timeoutSec = 20, int attempts = 2) {

    long hardEnd = System.currentTimeMillis() + (timeoutSec * 1000L)
    Exception last = null

    File f = new File(fullFilePath)
    String folderPath = f.getParent()
    String fileNameOnly = f.getName()

    Robot r = new Robot()
    r.setAutoDelay(20)

    for (int i = 1; i <= attempts; i++) {

        if (System.currentTimeMillis() > hardEnd) {
            break
        }

        try {
            Windows.delay(1)

            chord(r, KeyEvent.VK_CONTROL, KeyEvent.VK_L)
            Windows.delay(0.2)

            typeText(r, folderPath)
            Windows.delay(0.2)

            tap(r, KeyEvent.VK_ENTER)
            Windows.delay(1.0)

            tap(r, KeyEvent.VK_TAB)
            Windows.delay(0.2)
            tap(r, KeyEvent.VK_TAB)
            Windows.delay(0.2)

            typeText(r, fileNameOnly)
            Windows.delay(0.2)

            tap(r, KeyEvent.VK_ENTER)
            Windows.delay(0.8)

            return

        } catch (Exception e) {
            last = e
            Windows.delay(1)
        }
    }

    throw new Exception("Import file failed. Path=[" + fullFilePath + "] Error=[" + (last != null ? last.getMessage() : "n/a") + "]")
}

void tap(Robot r, int key) {
    r.keyPress(key)
    r.keyRelease(key)
}

void chord(Robot r, int mod, int key) {
    r.keyPress(mod)
    r.keyPress(key)
    r.keyRelease(key)
    r.keyRelease(mod)
}

void chord3(Robot r, int mod1, int mod2, int key) {
    r.keyPress(mod1)
    r.keyPress(mod2)
    r.keyPress(key)
    r.keyRelease(key)
    r.keyRelease(mod2)
    r.keyRelease(mod1)
}

void typeText(Robot r, String text) {

    for (int i = 0; i < text.length(); i++) {

        char c = text.charAt(i)

        if (c == '\\') { tap(r, KeyEvent.VK_BACK_SLASH); continue }
        if (c == '/')  { tap(r, KeyEvent.VK_SLASH); continue }
        if (c == ':')  { chord(r, KeyEvent.VK_SHIFT, KeyEvent.VK_SEMICOLON); continue }
        if (c == '.')  { tap(r, KeyEvent.VK_PERIOD); continue }
        if (c == '-')  { tap(r, KeyEvent.VK_MINUS); continue }
        if (c == '_')  { chord(r, KeyEvent.VK_SHIFT, KeyEvent.VK_MINUS); continue }
        if (c == ' ')  { tap(r, KeyEvent.VK_SPACE); continue }
        if (c == '(')  { chord(r, KeyEvent.VK_SHIFT, KeyEvent.VK_9); continue }
        if (c == ')')  { chord(r, KeyEvent.VK_SHIFT, KeyEvent.VK_0); continue }
        if (c == '+')  { chord(r, KeyEvent.VK_SHIFT, KeyEvent.VK_EQUALS); continue }
        if (c == '=')  { tap(r, KeyEvent.VK_EQUALS); continue }

        int code = KeyEvent.getExtendedKeyCodeForChar((int) c)
        if (code == KeyEvent.VK_UNDEFINED) {
            throw new IllegalArgumentException("Unsupported char: [" + c + "] in text: [" + text + "]")
        }

        boolean needShift = Character.isUpperCase(c)

        if (needShift) r.keyPress(KeyEvent.VK_SHIFT)
        r.keyPress(code)
        r.keyRelease(code)
        if (needShift) r.keyRelease(KeyEvent.VK_SHIFT)
    }
}
