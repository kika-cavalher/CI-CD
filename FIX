import java.awt.Robot
import java.awt.event.KeyEvent
import java.io.File

void importFile(String fullFilePath) {

    File f = new File(fullFilePath)
    String folderPath   = f.getParent()
    String fileNameOnly = f.getName()

    Robot r = new Robot()

    // ✅ Ctrl+L
    pressChord(r, KeyEvent.VK_CONTROL, KeyEvent.VK_L)
    Windows.delay(0.3)

    // ✅ Type folder path (no paste)
    typeText(r, folderPath)
    Windows.delay(0.2)

    // ✅ Enter to navigate
    pressKey(r, KeyEvent.VK_ENTER)
    Windows.delay(1.2)

    // ✅ TAB x2
    pressKey(r, KeyEvent.VK_TAB)
    Windows.delay(0.2)
    pressKey(r, KeyEvent.VK_TAB)
    Windows.delay(0.2)

    // ✅ Alt+N
    pressChord(r, KeyEvent.VK_ALT, KeyEvent.VK_N)
    Windows.delay(0.3)

    // ✅ Type file name
    typeText(r, fileNameOnly)
    Windows.delay(0.2)

    // ✅ Enter to open
    pressKey(r, KeyEvent.VK_ENTER)
    Windows.delay(0.5)
}

void pressKey(Robot r, int keyCode) {
    r.keyPress(keyCode)
    r.keyRelease(keyCode)
}

void pressChord(Robot r, int modifier, int key) {
    r.keyPress(modifier)
    r.keyPress(key)
    r.keyRelease(key)
    r.keyRelease(modifier)
}

/*
  Types text reliably with Robot.
  Works for: letters, numbers, \, :, ., _, -, space
  If you have special chars, tell me which.
*/
void typeText(Robot r, String text) {
    // Clear current field first (Ctrl+A)
    pressChord(r, KeyEvent.VK_CONTROL, KeyEvent.VK_A)
    Windows.delay(0.1)

    for (char c : text.toCharArray()) {
        typeChar(r, c)
    }
}

void typeChar(Robot r, char c) {
    boolean upper = Character.isUpperCase(c)
    int keyCode = KeyEvent.getExtendedKeyCodeForChar((int) c)

    if (keyCode == KeyEvent.VK_UNDEFINED) {
        throw new IllegalArgumentException("Unsupported char for Robot typing: " + c)
    }

    if (upper) r.keyPress(KeyEvent.VK_SHIFT)
    r.keyPress(keyCode)
    r.keyRelease(keyCode)
    if (upper) r.keyRelease(KeyEvent.VK_SHIFT)

    // small delay for stability
    try { Thread.sleep(10) } catch(Exception ignored) {}
}
