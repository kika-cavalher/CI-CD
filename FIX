import java.awt.Robot
import java.awt.Toolkit
import java.awt.datatransfer.StringSelection
import java.awt.event.KeyEvent
import java.io.File
import org.openqa.selenium.Keys
import com.kms.katalon.core.windows.keyword.WindowsBuiltinKeywords as Windows

void importFile(String fullFilePath) {

    File f = new File(fullFilePath)
    String folderPath   = f.getParent()
    String fileNameOnly = f.getName()

    Robot r = new Robot()

    // ✅ Clipboard = folder path
    Toolkit.getDefaultToolkit().getSystemClipboard()
        .setContents(new StringSelection(folderPath), null)

    // ✅ Ctrl+L
    Windows.sendKeys(null, Keys.chord(Keys.CONTROL, "l"))
    Windows.delay(0.3)

    // ✅ Ctrl+V (Robot)
    r.keyPress(KeyEvent.VK_CONTROL); r.keyPress(KeyEvent.VK_V)
    r.keyRelease(KeyEvent.VK_V);     r.keyRelease(KeyEvent.VK_CONTROL)
    Windows.delay(0.3)

    // ✅ Enter to navigate to folder
    r.keyPress(KeyEvent.VK_ENTER)
    r.keyRelease(KeyEvent.VK_ENTER)
    Windows.delay(1.2)

    // ✅ TAB x2 (as you verified manually)
    Windows.sendKeys(null, Keys.TAB)
    Windows.delay(0.2)
    Windows.sendKeys(null, Keys.TAB)
    Windows.delay(0.2)

    // ✅ Alt+N (focus file name)
    r.keyPress(KeyEvent.VK_ALT); r.keyPress(KeyEvent.VK_N)
    r.keyRelease(KeyEvent.VK_N); r.keyRelease(KeyEvent.VK_ALT)
    Windows.delay(0.3)

    // ✅ Type file name + Enter
    Windows.sendKeys(null, Keys.chord(Keys.CONTROL, "a"))
    Windows.delay(0.2)
    Windows.sendKeys(null, fileNameOnly)
    Windows.delay(0.2)

    r.keyPress(KeyEvent.VK_ENTER)
    r.keyRelease(KeyEvent.VK_ENTER)
    Windows.delay(0.5)
}
