import java.io.File
import java.awt.Robot
import java.awt.event.KeyEvent
import org.openqa.selenium.Keys
import com.kms.katalon.core.windows.keyword.WindowsBuiltinKeywords as Windows
import com.katalon.keywords.windows.WindowsImageKeywords

void importFile(String fileName) {

    Export export = new Export()

    File f = new File(fileName)
    String folderPath   = f.getParent()
    String fileNameOnly = f.getName()

    Robot r = new Robot()

    // ✅ 1) Your part (works): click address/path field + paste folder
    WindowsImageKeywords.clickImage(images.fileTopDialog)
    export.simulateCtrlV()
    Windows.delay(0.3)

    // ✅ 2) ENTER to open the folder (instead of clicking any image)
    r.keyPress(KeyEvent.VK_ENTER)
    r.keyRelease(KeyEvent.VK_ENTER)
    Windows.delay(1.2)

    // ✅ 3) TAB x2 (your manual flow to reach the next focus point)
    Windows.sendKeys(null, Keys.TAB)
    Windows.delay(0.2)
    Windows.sendKeys(null, Keys.TAB)
    Windows.delay(0.2)

    // ✅ 4) Alt+N to focus "File name"
    r.keyPress(KeyEvent.VK_ALT); r.keyPress(KeyEvent.VK_N)
    r.keyRelease(KeyEvent.VK_N); r.keyRelease(KeyEvent.VK_ALT)
    Windows.delay(0.2)

    // ✅ 5) TYPE the file name (no images)
    // Clear + type
    Windows.sendKeys(null, Keys.chord(Keys.CONTROL, "a"))
    Windows.delay(0.1)
    Windows.sendKeys(null, fileNameOnly)
    Windows.delay(0.2)

    // ✅ 6) ENTER to open the file
    r.keyPress(KeyEvent.VK_ENTER)
    r.keyRelease(KeyEvent.VK_ENTER)
    Windows.delay(0.6)
}
